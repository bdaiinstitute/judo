judo.simulation
===============

.. py:module:: judo.simulation


Submodules
----------

.. toctree::
   :maxdepth: 1

   /api/judo/simulation/base/index
   /api/judo/simulation/mj_simulation/index
   /api/judo/simulation/policy_mj_simulation/index




Package Contents
----------------

.. py:class:: Simulation(init_task: str = 'cylinder_push', task_registration_cfg: omegaconf.DictConfig | None = None)

   Bases: :py:obj:`abc.ABC`


   
   Base class for a simulation object.

   This class contains the data required to run a simulation. This includes configurations and task information.
   It can be inherited from to implement specific simulation backends.

   Middleware nodes should instantiate this class and implement methods to send, process, and receive data.

   .. py:attribute:: paused
      :value: False



   .. py:method:: set_task(task_name: str) -> None

      
      Initialize task from task name.


   .. py:method:: step(command: numpy.ndarray) -> None
      :abstractmethod:


      
      Step the simulation forward by one timestep.

      :param command: Control command for this timestep.


   .. py:method:: pause() -> None

      
      Toggle paused state.


   .. py:property:: timestep
      :type: float

      :abstractmethod:


      
      Timestep the simulation expects to run at.


.. py:class:: MJSimulation(init_task: str = 'spot_base', task_registration_cfg: omegaconf.DictConfig | None = None)

   Bases: :py:obj:`judo.simulation.base.Simulation`


   
   MuJoCo simulation with direct actuator control.

   Applies controls directly to MuJoCo actuators and steps
   the physics simulation forward.

   .. py:method:: step(command: numpy.ndarray) -> None

      
      Step the simulation forward.

      :param command: Control array in task format (task.nu dimensions).


   .. py:method:: set_task(task_name: str) -> None

      
      Set the current task.

      :param task_name: Name of the task to set.


   .. py:property:: sim_state
      :type: judo.app.structs.MujocoState


      
      Returns the current simulation state.


   .. py:property:: timestep
      :type: float


      
      Returns the effective simulation timestep (accounting for substeps).


.. py:class:: PolicyMJSimulation(init_task: str = 'spot_base', task_registration_cfg: omegaconf.DictConfig | None = None)

   Bases: :py:obj:`judo.simulation.mj_simulation.MJSimulation`


   
   MuJoCo simulation with locomotion policy support.

   For tasks with locomotion_policy_path set, uses C++ mujoco_extensions
   threaded_rollout to run the neural network policy at 50Hz.

   The simulation maintains internal state for the locomotion policy
   (last_policy_output) to ensure smooth transitions between timesteps.

   .. py:method:: step(command: numpy.ndarray) -> None

      
      Step the simulation forward.

      Routes to the C++ policy rollout if systems are initialized,
      otherwise falls back to direct actuator control.

      :param command: Control array in task format (task.nu dimensions).
                      For locomotion tasks, will be converted to policy command internally.


   .. py:method:: reset_policy_state() -> None

      
      Reset the internal policy state to zeros.


   .. py:method:: set_task(task_name: str) -> None

      
      Set the current task and reinitialize C++ systems if needed.

      :param task_name: Name of the task to set.


   .. py:property:: last_policy_output
      :type: numpy.ndarray


      
      Returns the last policy output (12-dim leg actions).


